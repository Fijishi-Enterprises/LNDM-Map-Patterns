# context("class level calc")
#
# fs_patch = data.frame(
#     metric = c(
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "area",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "perimeter-area-ratio",
#         "euclidean nearest neighbor distance distribution (mean)"
#     ),
#     class = c(
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         3,
#         3,
#         3,
#         3,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         3,
#         3,
#         3,
#         3,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         1,
#         3,
#         3,
#         3,
#         3,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         2,
#         NA
#     ),
#     id = c(
#         1,
#         5,
#         8,
#         16,
#         19,
#         22,
#         23,
#         25,
#         26,
#         2,
#         4,
#         21,
#         27,
#         3,
#         6,
#         7,
#         9,
#         10,
#         11,
#         12,
#         13,
#         14,
#         15,
#         17,
#         18,
#         20,
#         24,
#         1,
#         5,
#         8,
#         16,
#         19,
#         22,
#         23,
#         25,
#         26,
#         2,
#         4,
#         21,
#         27,
#         3,
#         6,
#         7,
#         9,
#         10,
#         11,
#         12,
#         13,
#         14,
#         15,
#         17,
#         18,
#         20,
#         24,
#         1,
#         5,
#         8,
#         16,
#         19,
#         22,
#         23,
#         25,
#         26,
#         2,
#         4,
#         21,
#         27,
#         3,
#         6,
#         7,
#         9,
#         10,
#         11,
#         12,
#         13,
#         14,
#         15,
#         17,
#         18,
#         20,
#         24,
#         NA
#     ),
#     value_fs = c(
#         1e-04,
#         0.0148,
#         5e-04,
#         0.0014,
#         1e-04,
#         5e-04,
#         1e-04,
#         1e-04,
#         3e-04,
#         9e-04,
#         0.0457,
#         0.001,
#         3e-04,
#         0.0035,
#         0.0057,
#         0.0024,
#         2e-04,
#         1e-04,
#         2e-04,
#         3e-04,
#         3e-04,
#         4e-04,
#         2e-04,
#         0.0098,
#         3e-04,
#         1e-04,
#         7e-04,
#         4,
#         130,
#         12,
#         20,
#         4,
#         10,
#         4,
#         4,
#         8,
#         16,
#         348,
#         16,
#         8,
#         38,
#         40,
#         32,
#         6,
#         4,
#         6,
#         8,
#         8,
#         8,
#         8,
#         82,
#         8,
#         4,
#         12,
#         40000,
#         8783.7838,
#         24000,
#         14285.7143,
#         40000,
#         20000,
#         40000,
#         40000,
#         26666.6667,
#         17777.7778,
#         7614.8796,
#         16000,
#         26666.6667,
#         10857.1429,
#         7017.5439,
#         13333.3333,
#         30000,
#         40000,
#         30000,
#         26666.6667,
#         26666.6667,
#         20000,
#         40000,
#         8367.3469,
#         26666.6667,
#         40000,
#         17142.8571,
#         NA
#     )
# )
#
# lsm_patch = lsm_calculate(landscape, what = "patch")
#
# patch = left_join(fs_patch, lsm_patch, by = c("metric", "class", "id"))
# a = as.list(patch$value_fs)
# b = as.list(patch$value)
# names(a) = paste0("Metric: ", patch$metric, ", Class: ", patch$class, ", ID: ", patch$id)
# names(b) = paste0("Metric: ", patch$metric, ", Class: ", patch$class, ", ID: ", patch$id)
#
# test_that("class level results are equal to fragstats", {
#     expect_equal(a, b, tolerance = 0.01)
# })
