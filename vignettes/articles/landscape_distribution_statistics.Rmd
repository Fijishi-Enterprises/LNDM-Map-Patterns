---
title: "Landscape distribution statistics"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
---

Landscape distribution statistics summarise the properties of all patches belonging the same class *i* or of all patches in the landscape together (McGarigal et al. 2012). This includes for example the mean, the coefficient of variation or the standard deviation of a certain metric. These measures are implemented in the  **landscapemetrics** package and are indicated by the corresponding suffixes (`_mn`, `_cv`, `_sd`). However, also other distribution statistics might be of interest. Even though they are not implemented in **landscapemetrics** yet, the integration in the `R` environment allows to calculate them quite easily. 

```{r packages, message = FALSE}
library(landscapemetrics)
library(raster)
library(dplyr)
```

## Area-weighted mean

First, we need to calculate the metric of interest on patch level. Addtionally, we need the patch area of each patch.

```{r mean_a}
# calculate required metric for each patch (e.g. lsm_p_shape)
metric_patch <- lsm_p_shape(landscape)

# calculate area for each patch
area_patch <- lsm_p_area(landscape)
```

Now, we simply need to join the metric value with the area of each patch, multiply the two values and calculate the area-weighted mean. To calculate the area-weighted mean on landscape-level, simply comment out the `dplyr::group_by()`-line.

```{r mean_b}
# calculate weighted mean
metric_wght_mean <- left_join(x = metric_patch, y = area_patch, 
                              by = c("layer", "level", "class", "id")) %>%
  dplyr::mutate(value.w = value.x * value.y) %>%
  dplyr::group_by(class) %>%
  dplyr::summarise(value.am = sum(value.w) / sum(value.y)) 

metric_wght_mean
```

## Range

The range equals the minimum value subtracted from the maximum value of the metric of interest for each patch (McGarigal et al. 2012). This can be calculated easily using the `min()/max()` function or the `range()` function.

```{r range}
# class level
metric_range_c <- dplyr::group_by(metric_patch, class) %>% 
    dplyr::summarise(range = max(value) - min(value))

# landscape level
metric_range_l <- diff(range(metric_patch$value))

metric_range_c
metric_range_l
```

## Median 
The median simply equals the value that divides all (ordered) values into two equal groups. There is an base `R` function available that can be applied to values grouped by class or all values (landscape-level). 

```{r median}
# class level
metric_md_c <- dplyr::group_by(metric_patch, class) %>% 
    dplyr::summarise(median = median(value))

# landscape level
metric_md_l <- median(metric_patch$value)

metric_md_c
metric_md_l
```

### References 

- McGarigal, K., Cushman, S.A., and Ene E. 2012. FRAGSTATS v4: Spatial Pattern Analysis Program for Categorical and Continuous Maps. Computer software program produced by the authors at the University of Massachusetts, Amherst. Available at the following website: <http://www.umass.edu/landeco/research/fragstats/fragstats.html>
